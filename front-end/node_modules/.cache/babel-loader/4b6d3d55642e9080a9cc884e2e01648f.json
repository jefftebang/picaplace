{"ast":null,"code":"import _regeneratorRuntime from\"/Users/zemiragabrielle/Documents/Jeff's/Web Development Course/MERN/fligno/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/zemiragabrielle/Documents/Jeff's/Web Development Course/MERN/fligno/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/zemiragabrielle/Documents/Jeff's/Web Development Course/MERN/fligno/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{BrowserRouter as Router,Switch,Route,Redirect}from\"react-router-dom\";import axios from\"axios\";import Users from\"./user/pages/Users\";import NewPost from\"./posts/pages/NewPost\";import MainNav from\"./global/components/Navbar/MainNav\";import UserPosts from\"./posts/pages/UserPosts\";import UpdatePost from\"./posts/pages/UpdatePost\";import Login from\"./user/pages/Login\";import SignUp from\"./user/pages/SignUp\";import UserContext from\"./global/context/UserContext\";var App=function App(){var _useState=useState({token:undefined,user:undefined}),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserData=_useState2[1];useEffect(function(){var checkLoggedIn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,tokenRes,userRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=localStorage.getItem(\"x-auth-token\");if(token===null){localStorage.setItem(\"x-auth-token\",\"\");token=\"\";}_context.next=4;return axios.post(process.env.REACT_APP_BACKEND_URL+\"/users/tokenIsValid\",null,{headers:{\"x-auth-token\":token}});case 4:tokenRes=_context.sent;if(!tokenRes.data){_context.next=10;break;}_context.next=8;return axios.get(\"REACT_APP_BACKEND_URL/api/api/users/users\",{headers:{\"x-auth-token\":token}});case 8:userRes=_context.sent;setUserData({token:token,user:userRes.data});case 10:case\"end\":return _context.stop();}}},_callee);}));return function checkLoggedIn(){return _ref.apply(this,arguments);};}();checkLoggedIn();},[]);var routes;if(sessionStorage.token){routes=/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{path:\"/users\",exact:true},/*#__PURE__*/React.createElement(Users,null)),/*#__PURE__*/React.createElement(Route,{path:\"/:userId/posts\",exact:true},/*#__PURE__*/React.createElement(UserPosts,null)),/*#__PURE__*/React.createElement(Route,{path:\"/posts/new\",exact:true},/*#__PURE__*/React.createElement(NewPost,null)),/*#__PURE__*/React.createElement(Route,{path:\"/posts/:postId\",component:UpdatePost}),/*#__PURE__*/React.createElement(Redirect,{to:\"/users\"}));}else{routes=/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{path:\"/login\"},/*#__PURE__*/React.createElement(Login,null)),/*#__PURE__*/React.createElement(Route,{path:\"/signup\"},/*#__PURE__*/React.createElement(SignUp,null)),/*#__PURE__*/React.createElement(Redirect,{to:\"/login\"}));}return/*#__PURE__*/React.createElement(Router,null,/*#__PURE__*/React.createElement(UserContext.Provider,{value:{userData:userData,setUserData:setUserData}},sessionStorage.token&&/*#__PURE__*/React.createElement(MainNav,null),routes));};export default App;","map":{"version":3,"sources":["/Users/zemiragabrielle/Documents/Jeff's/Web Development Course/MERN/fligno/front-end/src/App.js"],"names":["React","useState","useEffect","BrowserRouter","Router","Switch","Route","Redirect","axios","Users","NewPost","MainNav","UserPosts","UpdatePost","Login","SignUp","UserContext","App","token","undefined","user","userData","setUserData","checkLoggedIn","localStorage","getItem","setItem","post","process","env","REACT_APP_BACKEND_URL","headers","tokenRes","data","get","userRes","routes","sessionStorage"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from \"react-router-dom\";\nimport axios from \"axios\";\nimport Users from \"./user/pages/Users\";\nimport NewPost from \"./posts/pages/NewPost\";\nimport MainNav from \"./global/components/Navbar/MainNav\";\nimport UserPosts from \"./posts/pages/UserPosts\";\nimport UpdatePost from \"./posts/pages/UpdatePost\";\nimport Login from \"./user/pages/Login\";\nimport SignUp from \"./user/pages/SignUp\";\nimport UserContext from \"./global/context/UserContext\";\n\nconst App = () => {\n  const [userData, setUserData] = useState({\n    token: undefined,\n    user: undefined,\n  });\n\n  useEffect(() => {\n    const checkLoggedIn = async () => {\n      let token = localStorage.getItem(\"x-auth-token\");\n      if (token === null) {\n        localStorage.setItem(\"x-auth-token\", \"\");\n        token = \"\";\n      }\n      const tokenRes = await axios.post(\n        process.env.REACT_APP_BACKEND_URL + \"/users/tokenIsValid\",\n        null,\n        { headers: { \"x-auth-token\": token } }\n      );\n      if (tokenRes.data) {\n        const userRes = await axios.get(\n          \"REACT_APP_BACKEND_URL/api/api/users/users\",\n          {\n            headers: { \"x-auth-token\": token },\n          }\n        );\n        setUserData({\n          token,\n          user: userRes.data,\n        });\n      }\n    };\n\n    checkLoggedIn();\n  }, []);\n\n  let routes;\n  if (sessionStorage.token) {\n    routes = (\n      <Switch>\n        <Route path=\"/users\" exact>\n          <Users />\n        </Route>\n        <Route path=\"/:userId/posts\" exact>\n          <UserPosts />\n        </Route>\n        <Route path=\"/posts/new\" exact>\n          <NewPost />\n        </Route>\n        <Route path=\"/posts/:postId\" component={UpdatePost} />\n        <Redirect to=\"/users\" />\n      </Switch>\n    );\n  } else {\n    routes = (\n      <Switch>\n        <Route path=\"/login\">\n          <Login />\n        </Route>\n        <Route path=\"/signup\">\n          <SignUp />\n        </Route>\n        <Redirect to=\"/login\" />\n      </Switch>\n    );\n  }\n\n  return (\n    <Router>\n      <UserContext.Provider value={{ userData, setUserData }}>\n        {sessionStorage.token && <MainNav />}\n        {routes}\n      </UserContext.Provider>\n    </Router>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}